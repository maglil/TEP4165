
\documentclass{article}
\input{tep4165-preamble}


\begin{document}

\begin{center}
{\Large
TEP4165 2023 \\
Ã˜ving 1 \\
\normalsize
Magnus Lilledahl
}
\end{center}

\section*{Notation}

I will use the following notation

\begin{equation}
	\partial_t = \frac{\partial}{\partial t}, \quad \partial_x = \frac{\partial}{\partial x}
\end{equation}

\section*{Task 1}

\subsection*{a}
The energy equation is

\begin{equation}
	\partial_t (\rho E) + \div{(\rho H \u)} = \div{(\tau \cdot \u)} + \div{(k\grad{T}})+ \rho \vec{f} \cdot \u
\end{equation}

We will make the following assumptions

\begin{enumerate}[I]
	\item Incompressible material $\implies \partial_t \rho = 0, \quad c_p = c_v$
	\item No body forces, negligeble viscous forces.
	\item Constant thermal conductivty and heat capacity
	\item Velocities and velocity gradients are negligeble
	\item One-dimensional
\end{enumerate}

From II, the first and last term on right hand side will disappear. From III all terms involving $\u$ will disappear. This leaves us with

\begin{equation}
	\partial_t (\rho E) = + \div{(k\grad{T} )}
\end{equation}

From V this transforms into
\begin{equation}
	\partial_t (\rho E) = + \partial_x{(k\partial_x{T}})
\end{equation}

For the left hand side we get (the assumptions used are indicated over each equality)

\begin{align}
	\partial_t(\rho E) &= \partial_t (\rho e + \frac{1}{2}u^2) \overset{\text{IV}}{=} \partial_t(\rho e) = \rho \partial_t e + e \partial_t \rho \\
&\overset{\text{I}}{=}  \rho \partial_t e = \rho \partial_t c_v T \overset{\text{III}}{=} \rho c_v \partial T \overset{\text{I}}{=} \rho c_p \partial T
\end{align}

From III we have

\begin{equation}
	\partial_x{(k\partial_x{T}}) = k \partial_x^2 T
\end{equation}

Setting $\alpha = \frac{k}{\rho c_p}$ we thus get

\begin{equation}
	\partial_t T = \alpha \partial_x^2 T
\end{equation}



\subsection*{b}
Let [q] denote the dimensions of a quantity q. Let $L$, $M$, $T$ denote dimensions for length, mass and time, respectively (sorry for using same symbol for dimension length and characteristic length, hopefully clear from context.) Assume $[L] = L$, $[U] = \frac{L}{T}$, $[\rho] = \frac{M}{L^3}$. Then,

\begin{equation}
[\vec{x}^*] = \frac{[x]}{[L]} = \frac{L}{L} = 1
\end{equation}

\begin{equation}
[\vec{u}*] = \frac{[u]}{[U]} = \frac{L/T}{L/T} = 1 
\end{equation}

\begin{equation}
[t^*] = \frac{[t]}{[L/U]} = \frac{T}{ L / \frac{L}{T} } = 1
\end{equation}

\begin{equation}
[p^*] = \frac{p}{\rho U^2} = \frac{M L^{-1} T^{-2}}{M L^{-3} \cdot L^2T^{-2}} = 1
\end{equation}

Substituting for dimensional quantities in the incompressible Navier-Stokes equation

\begin{equation}
\frac{U}{L}\partial_{t^*} \vec{u^*} U + \vec{u^*} U \cdot \frac{1}{L}\nabla^* \vec{u^*} U = -\frac{1}{\rho} \frac{1}{L}\nabla^* p^* \rho U^2 + \nu \frac{1}{L^2}\vec{u}^*U
\end{equation}

Divide the whole equation by $\frac{U^2}{L}$ to yield (rename starred quantities as unstarred quantities)

\begin{equation}
\partial_t \vec{u} + \vec{u} \nabla \vec{u} = -\nabla p + \frac{\nu }{UL} \nabla^2 \vec{v}
\end{equation}

Introduce the Reynolds number $Re = \frac{UL}{\nu}$ results in

\begin{equation}
\partial_t \vec{u} + \vec{u}\cdot \nabla \vec{u}= -\nabla p + \frac{1}{\Re} \nabla^2 \vec{v}
\end{equation}

\section*{Task 2}

\subsection*{a}
The 1D heat equation is

\begin{equation}
\partial_t T = \alpha \partial_x^2 T
\end{equation}

We will assume that the solution can be written as the sum of the steady state solution $T_s$ and an unsteady part $T_t$.

\begin{equation}
T = T_s + T_t
\end{equation}

Plugging into the heat equation we get

\begin{equation}
\label{eq:heatparts}
\partial_t (T_s + T_t) = \alpha \partial_x^2 (T_s + T_t)
\end{equation}

Since $T_s$ represents the steady state solution it must satisfy

\begin{equation}
\label{eq:laplace}
\partial_x^2 T_s = 0
\end{equation}

while $T_s$ cancles from \ref{eq:heatparts} (left side since $T_s$ is independent of time and right side due to \ref{eq:laplace}) to give 

\begin{equation}
\label{eq:unsteady}
\partial_t T_t = \alpha \partial_x^2 T_t
\end{equation}

To simplify expressions introduce new variables $T' = T-T_1$ and $x' = x-L_1$. We will solve the equations with these variables (we will however for additional simplicity skip writing the primes). The boundary conditions are then 

\begin{align}
T(0) &= 0 \\
T(L) &= \Delta T
\end{align}

where $L = L_2-L_1$ and $\Delta T = T_2-T_1$ .

The solution to \ref{eq:laplace} is $T_s = ax + b$. Boundary condition at $x = 0$ implies $b=0$ and at $x=L$ implies $ a= \Delta T/L$. Thus,

\begin{equation}
T_s = \frac{\Delta T}{L} x
\end{equation}

For \ref{eq:unsteady}  Assume we cand find a solution using separation of variables

\begin{equation}
T_t = f(t)g(x)
\end{equation}

Inserting into \ref{eq:unsteady} results in

\begin{equation}
g\partial_t f = \alpha f \partial_x^2 g
\end{equation}

Divide through by $fg$ we get

\begin{equation}
\frac{\partial_t f}{f} = \alpha \frac{\partial_x^2 g}{g} = -k^2
\end{equation}

where we have introduced the  separation constant $k^2$. Since left side depends on $t$ only and the right on $x$ only, each side must be constant.

% Temporal part
For the time dependent $f$ we have

\begin{equation}
\partial_t f= -k^2 f
\end{equation}
with solution

\begin{equation}
f = A \exp{-k^2 t}
\end{equation}

The spatially dependent equation is

\begin{equation}
\partial_x^2 g = -\frac{k^2}{\alpha}g = -a^2 g
\end{equation}

with $k^2 = a^2 \alpha$ A solution is

\begin{equation}
g = B\cos(ax) + C \sin(ax)
\end{equation}

Since $T_s$ satisfy the boundary conditions we must have $T_t(0) = T_t(L) =0$ for the complete solution to also satisfy the boundary conditions. $T_t(0) =0$ implies $C = 0$. For the other end we then get

\begin{equation}
B \sin(aL) = 0
\end{equation}

which implies $a  = \frac{ n\pi}{L}$ and

\begin{equation}
k_n^2 = \frac{n^2\pi^2}{L^2}\alpha
\end{equation} 

The general solution is thus

\begin{equation}
g = \sum_n B_n \sin(\frac{n\pi x}{L}) 
\end{equation}

%Initial conditions

At $t=0$, $T$ must satisfy the inital condition $T = T_i$ (note this is really $T'_i = T_i - T_1$, we will make the substitution at the end). Thus we get

\begin{equation}
T_s + T_t(0) = T_s + A\sum_n B_n \sin(n\pi x/L) = T_i
\end{equation}

Rearranging and absorbing the factor $A$ into the $B_n$

\begin{equation}
\sum_n B_n \sin(n\pi x/L) = T_i -T_s = T_i - \frac{\Delta T}{L}x
\end{equation}

We can find the $B_n$ by Fourier's formule for a Fourier sine series.

\begin{equation}
B_n = \frac{2}{L} \int_0^L (T_i-\frac{\Delta T}{L}x) \sin(n\pi x /L) dx 
\end{equation}

For the first term in the integral we get

\begin{align}
\frac{2}{L} \int_0^L T_i \sin(n\pi x /L) dx  &= \frac{2 T_i}{L} (-\frac{L}{n\pi})\left[\cos(\frac{n\pi x}{L}) \right]_0^L \\ 
&= \frac{2 T_i}{L} (-\frac{L}{n\pi}) (\cos(n\pi) - \cos(0)) \\
&= - \frac{2 T_i}{n\pi}((-1)^n - 1)
\end{align}

For the second term we get

\begin{align}
	& -\frac{2\Delta T}{L^2} \int_0^L T_i x\sin(n\pi x /L) dx  \\
& = -\frac{2\Delta T}{L^2} \left[-x \cos(\frac{n\pi x}{L})\frac{L}{n\pi} + \sin(\frac{n\pi x}{L})\left(\frac{L}{n\pi}\right)^2\right]_0^L \\
&= \frac{2\Delta T}{Ln\pi} (L\cos( n \pi) + 0) \\
&= \frac{2\Delta T}{n\pi} (\cos( n \pi) \\
& = \frac{2\Delta T}{n\pi} (-1)^n
\end{align}

Combining both terms we get

\begin{equation}
	B_n = \frac{2}{n\pi} \left((\Delta T-T_i)(-1)^n + T_i \right)
\end{equation}

We can now make the subsitution $\Delta T = T_2 - T_1$ and $T_i \rightarrow T_i -T_1$ yielding

\begin{equation}
	B_n = \frac{2}{n\pi} \left((T_2 - T_i)(-1)^n - (T_1-T_i) \right)
\end{equation}

Thus we get for the final solution (making subsitutions $L = L_2-L_1$, $x' = x -L_1$, $k_n = \frac{n\pi\alpha}{L_2-L_1}$  )

\begin{align}
\label{eq:final}
	T &= T' + T_1 = T_s + T_t + T_1= T_s + fg + T_1 \\
	&= T_1 + \frac{T_2-T_1}{L_2-L_1}(x-L_1) + \sum_n e^{- \frac{n^2\pi^2}{(L_2-L_1)^2}\alpha   t}  \left(\frac{2}{n\pi} \left((T_2 - T_i)(-1)^n - (T_1-T_i) \right) \right) \sin(\frac{n\pi (x-L_1)}{L_2-L_1}) 
\end{align}
%\frac{n\pi\alpha}{L_2-L_1} 


\subsection*{b and c}

A program for numerically solving  (\ref{eq:final}) was written in matlab and is listed below. The series in (\ref{eq:final}) was truncated when the largest value at any position was less then the machine precision (This approach would require that the series is montonically decreasing. This has not been checked). A maximum of 200 terms were included. For $t0=0$ 200 terms were included while for all the other times less than 14 terms were included.

\lstinputlisting[language=matlab]{ps01.m}
\lstinputlisting[language=matlab]{Texact.m}

\includegraphics{ps01-1.png}

\end{document}
