\documentclass{article}
\input{../tep4165-preamble}

\begin{document}

\maketitle{8}

\section{Task 1}

Starting with the heat equation

\begin{equation}
0 = \partial_x \kappa \partial_x T
\end{equation}

we integrate this equation over a finite volume resulting in

\begin{equation}
\label{eq:fvm_exact}
0 = (\kappa \partial_x T)_w - (\kappa \partial_x T)_e = 0
\end{equation}

We have here assumed we are considering a volume of unit area cross-section. The partial derivatives at both faces is then approximated by central differences and multiply by the cell length, resulting in

\begin{equation}
0 = \kappa_w ( T_W - T_P ) - \kappa_e ( T_P - T_E )
\end{equation}

Assuming $\kappa$ constant this simplifies to

\begin{equation}
2 T_P - T_W - T_E = 0 
\end{equation}

i.e the coefficients are $a_P = 2$, $a_E = -1 $, $a_W = -1 $ for the interior grid points.

\textbf{Boundary values}

We have constant temperature at the boundary values. One way to deal with the boundary values would be to let the boundary be at a cell face and place a grid point at this location. When we approximate the western flux for (e.g.) the first (normal) grid point, we use the boundary value and the cell center value but the distance between these are half a cell length. We then end up with the modified equation for the first (normal) grid point

\begin{equation}
0 = 2\kappa ( T_W - T_P ) - \kappa ( T_P - T_E )
\end{equation}

resulting in

\begin{equation}
3 T_P - 2 T_W - T_E = 0 
\end{equation}

Similiar for the other boundary value.

\subsection{b)}
The declartion module declares the different variables used in the program. The module procedure containes one subroutine solve which solves an algebraic equation iteratively. There is also a module that is commented out for solving a linear equation system. 

The main program's stated goal is to solve the steady state heat equation. The main program calls the two(three) modules and calls to internal routines init and grid

The init subroutine asks the user for numper of nodal points and max iterations. It then defines some material and system parameters as well as allocating and setting arrays.

The grid subroutine defines the position of the grid points. The grid spacing is npi-2 since there are two special boundary value points. x_face(i) is the western face of grid point x(i).

The main program then allocates the arrays for the FVM coefficients.

The program then starts the main iteration loop to solve the algebraic equation. The loop first calls a subroutines bound() which sets the boundary values. It then calls Tcoeff which calculates thermal conductivities at cell faces as averages of cell center values (in case variable) and also uses a potentially variable area for calculation of the thermal conductivity. 

In our case the thermal conducitivity cancels out since we don't have any source terms and can be simplified accordingly

The main loop then calls solve to solve the algebraic equation iteratively.	

\end{document}
